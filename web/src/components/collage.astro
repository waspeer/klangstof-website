---
import * as sanity from '../lib/sanity.js';

const {photo} = await sanity.query(/* groq */ `
  *[_id == 'general'][0] {
    photo {
      ...
    }
  }
`);
const photoUrl = sanity.imageUrl(photo).width(1200).auto('format').url()!;
---

<section class="collage full-bleed">
  <div class="layer" data-depth="0.15">
    <div class="shadow" />
  </div>
  <div class="layer" data-depth="0.2">
    <div class="photo" style={`background-image: url('${photoUrl}');`} />
  </div>
  <div class="layer" data-depth="0.3">
    <h1 class="logo">KLANGSTOF</h1>
  </div>
  <div class="layer" data-depth="0.5">
    <div class="overlay" />
  </div>
</section>

<script type="module" hoist>
    document.querySelectorAll('.collage').forEach((collage) => {
        new Parallax(collage);
    })
</script>

<style lang="scss">
  .collage {
    overflow: hidden;
    min-height: 100vh;
  }

  .layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .shadow {
    position: absolute;
    top: 10vh;
    left: calc(20vw - 50px);
    width: 25vw;
    height: 65vh;
    background-color: var(--color-text);

    @media (orientation: portrait) {
      top: calc(20vh + 10px);
      left: calc(20vw + 10px);
      width: 60vw;
      height: 45vh;
    }
  }

  .photo {
    position: absolute;
    top: 20vh;
    left: 20vw;
    width: 60vw;
    height: 45vh;
    background-position: center 10%;
    background-repeat: no-repeat;
    background-size: cover;
  }

  .logo {
    position: absolute;
    bottom: 27vh;
    left: 18vw;
    width: 80vw;
    height: 20vh;
    color: var(--gray-10);
    font-size: 10vw;
    font-weight: bold;

    @media (orientation: portrait) {
      top: 55vh;
      left: 15vw;
    }
  }

  .overlay {
    position: absolute;
    top: 10vh;
    left: 75vw;
    width: 10vw;
    height: 10vw;
    background-color: var(--rose-200);
    opacity: 0.6;

    @media (orientation: portrait) {
      display: none;
    }
  }
</style>